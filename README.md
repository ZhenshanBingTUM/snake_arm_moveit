# Snake_arm_moveit
We will see later

## How to Run it
### Step 0: Download the git into your workspace (catin_ws/src)
```
$ cd ~/catkin_ws
$ catkin_make
$ source ~/catkin_ws/devel/setup.bash
```
### Step 1: Launch the Gazebo simulation
```
$ roslaunch IRB300_gazebo gazebo.launch
```
### Step 2: Launch the moveit plan package
```
$ roslaunch moveit_IRB300 demo_planning_execution.launch
```

## Instructions for simulating Gazebo and Moveit together
### 1. Export URDF from Solidworks
You have to install the [Solidworks-Urdf Exporter](http://wiki.ros.org/sw_urdf_exporter) first.

### 2. Verify the joints configuration (axis, rotating direction)
launch moveit setup assistant, you can check the configuration in step "Robot Pose"
```
roslaunch moveit_setup_assistant setup_assistant.launch
```
### 3. Verify your urdf in gazebo
1). Create ROS Package "XXX_gazebo" for launching in gazebo.

2). Copy the "gazebo.launch" (automatically generated by the exporter) to your "XXX_gazebo" package.

3). Launch and examine it (You may check and edit the urdf path in the file gazebo.launch).

### 4. Create MoveIt Pacakge using setup assistant
Then you will have your package and you can examine it by running
```
$ roslaunch moveit_IRB300 demo.launch
```
Examine it by following the [moveit tutorial](http://docs.ros.org/kinetic/api/moveit_tutorials/html/doc/quickstart_in_rviz/quickstart_in_rviz_tutorial.html#getting-started).

### 5. Prepare all the files for connecting MoveIt and Gazebo
#### 1). URDF file
a. Add gazebo plugin
```
<gazebo>
    <plugin name="ros_control" filename="libgazebo_ros_control.so">
      
    </plugin>
  </gazebo>
``` 
b. Add URDF transmission element
```
<transmission name="tranX">
    <type>transmission_interface/SimpleTransmission</type>
    <joint name="joint_X">
      <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
    </joint>
    <actuator name="motorX">
      <mechanicalReduction>1</mechanicalReduction>
    </actuator>
  </transmission>
```
#### 2). Launch file
a. Add "robot_state_publisher"
b. Add "fake_joint_calibration"
c. Add "joint_state_controler"
d. Add "arm_controller"

#### 3). Examine it by checking avalible rostopics (arm_controller)

#### 4). Prepare MoveIt files
a. Create the *controller.yaml* in "/moveit_IRB300/config"

First of all, you have to create a file to define how you will control the joints of your "real" robot.

b. Create the *joint_names.yaml* in "/moveit_IRB300/config"

You will have to create a file to define the names of the joints of your robot.

c. Modify *IRB300_description_moveit_controller_manager.launch.xml* in "/moveit_IRB300/launch"

By doing this, you will load the *controller.yaml*, and the *MoveItSimpleControllerManager* plugin, which will allow you to send the plans calculated in MoveIt to your "real" robot, in this case, the simulated robot.

d. Create *demo_planning_execution.launch*

Finally, you will have to create a new launch file that sets up all the system to control your robot. 


## Possible issues

* 'position_controllers/JointTrajectoryController' does not exist
```
$ sudo apt-get install ros-kinetic*controllers*
```

## Notes
[ROS Q&A](https://www.youtube.com/watch?v=j6bBxfD_bYs&t=1156s)
